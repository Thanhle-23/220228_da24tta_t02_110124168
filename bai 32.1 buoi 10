// Chuong trinh hien thi va tim kiem san pham
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct {
    int ngay;
    int thang;
    int nam;
} NGAY_THANG;

typedef struct {
    char maSanPham[20];
    char tenSanPham[50];
    float donGia;
    NGAY_THANG ngaySanXuat;
    float thoiGianSuDung;
} SAN_PHAM;
void hienThiSanPham(SAN_PHAM sp){
	printf("Ma SP: %s\nTen SP: %s\nDon Gia: %.2f\nNgay SX: %02d/%02d/%04d\nThoi Gian SD: %.2f\n",
                   sp.maSanPham, sp.tenSanPham, sp.donGia,
                   sp.ngaySanXuat.ngay, sp.ngaySanXuat.thang, sp.ngaySanXuat.nam,
                   sp.thoiGianSuDung);
}
void hienThiDanhSachSanPham(const char *tenTep) {
    FILE *file = fopen(tenTep, "rb");
    if (file == NULL) {
        printf("Khong the mo tep %s de doc!\n", tenTep);
        return;
    }

    SAN_PHAM sp;
    printf("%-20s %-50s %-10s %-15s %-20s\n", "Ma SP", "Ten SP", "Don Gia", "Ngay SX", "Thoi Gian SD");
    while (fread(&sp, sizeof(SAN_PHAM), 1, file)) {
        printf("%-20s %-50s %-10.2f %02d/%02d/%04d %-20.2f\n",
               sp.maSanPham, sp.tenSanPham, sp.donGia,
               sp.ngaySanXuat.ngay, sp.ngaySanXuat.thang, sp.ngaySanXuat.nam,
               sp.thoiGianSuDung);
    }
    fclose(file);
}

void timKiemSanPhamTheoMa(const char *tenTep, const char *maSP) {
    FILE *file = fopen(tenTep, "rb");
    if (file == NULL) {
        printf("Khong the mo tep %s de doc!\n", tenTep);
        return;
    }

    SAN_PHAM sp;
    int timThay = 0;
    while (fread(&sp, sizeof(SAN_PHAM), 1, file)) {
        if (strcmp(sp.maSanPham, maSP) == 0) {
            printf("Thong tin san pham:\n");
            hienThiSanPham(sp);
            timThay = 1;
            break;
        }
    }

    if (!timThay) {
        printf("Khong tim thay san pham voi ma %s.\n", maSP);
    }

    fclose(file);
}

int main() {
    char tenTep[100];
    printf("Nhap ten tep chua danh sach san pham: ");
    scanf("%s", tenTep);

    printf("\nDanh sach san pham:\n");
    hienThiDanhSachSanPham(tenTep);

    char maSP[20];
    printf("\nNhap ma san pham can tim: ");
    scanf("%s", maSP);
    timKiemSanPhamTheoMa(tenTep, maSP);

    return 0;
}
